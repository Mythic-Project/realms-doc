(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{5617:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/createplugin",function(){return s(6356)}])},6356:function(e,n,s){"use strict";s.r(n),s.d(n,{__toc:function(){return c}});var i=s(5893),r=s(2673),t=s(2169),o=s(1255);s(2148),s(9488);var l=s(2643),a=s(2154);let c=[{depth:2,value:"What is a Voter Weight Plugin?",id:"what-is-a-voter-weight-plugin"},{depth:2,value:"How to Create a Voter Weight Plugin",id:"how-to-create-a-voter-weight-plugin"},{depth:3,value:"Part 1 - The Plugin Program",id:"part-1---the-plugin-program"},{depth:4,value:"Sample Registrar Account",id:"sample-registrar-account"},{depth:4,value:"Voter Weight Record",id:"voter-weight-record"},{depth:4,value:"Instructions",id:"instructions"},{depth:3,value:"Part 2 - The JS/TS Client",id:"part-2---the-jsts-client"},{depth:2,value:"Integrating with Realms",id:"integrating-with-realms"},{depth:2,value:"Voter Weight Plugin Chaining",id:"voter-weight-plugin-chaining"},{depth:3,value:"Supporting Chaining in the UI",id:"supporting-chaining-in-the-ui"},{depth:4,value:"Example",id:"example"},{depth:4,value:"Input Weights of First Plugin",id:"input-weights-of-first-plugin"}];function h(e){let n=Object.assign({h1:"h1",h2:"h2",p:"p",strong:"strong",em:"em",ul:"ul",li:"li",a:"a",ol:"ol",h3:"h3",code:"code",h4:"h4",pre:"pre",span:"span"},(0,l.a)(),e.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{children:"Create a Voter Weight Plugin"}),"\n",(0,i.jsx)(n.h2,{id:"what-is-a-voter-weight-plugin",children:"What is a Voter Weight Plugin?"}),"\n",(0,i.jsxs)(n.p,{children:["Realms is designed to be ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"modular"})}),", allowing for the addition of ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"plugins"})}),"\r\nthat can modify the voter weight of members in a DAO."]}),"\n",(0,i.jsx)(n.p,{children:"By default, the voter weight of a member is equal to the number of tokens they hold."}),"\n",(0,i.jsx)(n.p,{children:"However, if a DAO enables a plugin, the voter weight of a member can be modified."}),"\n",(0,i.jsx)(n.p,{children:"Example plugins are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/quadratic",children:"Quadratic Voting"})}),": The voter weight of a member is proportional to the square root of the number of tokens they hold."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/vsr",children:"Voter Stake Registry"})}),": A voter's weight can be increased by locking tokens."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/setup/daonft",children:"NFT"})}),": The voter weight of a member is proportional to the number and type of NFTs they hold."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"how-to-create-a-voter-weight-plugin",children:"How to Create a Voter Weight Plugin"}),"\n",(0,i.jsx)(n.p,{children:"There are two parts to creating a voter weight plugin:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"The on-chain program"}),"\n",(0,i.jsx)(n.li,{children:"The JS/TS client"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Plugins are stored in the ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/governance-program-library",children:"Goverance Program Library"}),", where you can see example plugins."]}),"\n",(0,i.jsxs)(a.Rg,{children:[(0,i.jsx)(n.h3,{id:"part-1---the-plugin-program",children:"Part 1 - The Plugin Program"}),(0,i.jsx)(n.p,{children:"The plugin program is a Solana program that modifies the voter weight of a member."}),(0,i.jsx)(n.p,{children:"It defines the following main account types:"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"Registrar"})]}),"\n"]}),(0,i.jsx)(n.p,{children:"This associates a plugin with a realm, and stores any configuration data that this plugin uses."}),(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"The Voter Weight Record (VWR)"}),"\n"]}),(0,i.jsx)(n.p,{children:"This is a record that stores the voter weight of a member according to this plugin.\r\nIt is updated before each vote and passed in as the voter weight to the voting instruction."}),(0,i.jsx)(n.p,{children:"The SPL-Governance program checks that the program ID of the VWR matches the expected program ID for\r\nthe governance, as well as checking that it is up to date."}),(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"The Maximum Voter Weight Record (Max VWR) (Optional)"}),"\n"]}),(0,i.jsx)(n.p,{children:"This record is used in the case where the plugin does not just modify a single voter's weight,\r\nbut also the total maximum votes of a realm. An example is an NFT DAO where the total maximum votes\r\ndepends on the number and type of all NFTs in a collection."}),(0,i.jsx)(n.h4,{id:"sample-registrar-account",children:"Sample Registrar Account"}),(0,i.jsx)(n.pre,{"data-language":"rust","data-theme":"default",children:(0,i.jsxs)(n.code,{"data-language":"rust","data-theme":"default",children:[(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"pub"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"struct"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Registrar"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    /// spl-governance program the Realm belongs to"})}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"pub"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" governance_program_id"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Pubkey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:" "}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    /// Realm of the Registrar"})}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"pub"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" realm"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Pubkey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:" "}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    /// Governing token mint the Registrar is for"})}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    /// It can either be the Community or the Council mint of the Realm"})}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"pub"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" governing_token_mint"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Pubkey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:","})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:" "}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    /// If the plugin is one in a sequence, this is the previous plugin program ID"})}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    /// If set, then update_voter_weight_record will expect a voter_weight_record owned by this program"})}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"pub"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" previous_voter_weight_plugin_program_id"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Option"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Pubkey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:">,"})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    /// ...add your configuration here"})}),"\n",(0,i.jsx)(n.span,{className:"line",children:" "}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    /// Reserved for future upgrades"})}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"pub"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" reserved"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"u8"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"; "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"128"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"],"})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),(0,i.jsx)(n.h4,{id:"voter-weight-record",children:"Voter Weight Record"}),(0,i.jsxs)(n.p,{children:["The structure of a Voter Weight record is fixed by the SPL-Governance program.\r\nSee ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/solana-program-library/blob/master/governance/addin-api/src/voter_weight.rs",children:"here"})," for its structure."]}),(0,i.jsx)(n.h4,{id:"instructions",children:"Instructions"}),(0,i.jsx)(n.p,{children:"Your program is expected to have instructions to create and update the voter weight record."}),(0,i.jsx)(n.p,{children:"These will be called by your JS/TS client."}),(0,i.jsx)(n.h3,{id:"part-2---the-jsts-client",children:"Part 2 - The JS/TS Client"}),(0,i.jsx)(n.p,{children:"The JS/TS client is a JS plugin for the Realms UI, allowing the UI to interact with your plugin program\r\nat voting time, and when a user joins a DAO."}),(0,i.jsxs)(n.p,{children:["The client must implement the ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/governance-program-library/blob/master/src/common/Client.ts",children:"Client interface"})," in governance-program-library."]}),(0,i.jsx)(n.p,{children:"The client provides implementations for"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"creating and updating voter weights and max voter weights,"}),"\n",(0,i.jsx)(n.li,{children:"creating and configuring registrars, and"}),"\n",(0,i.jsx)(n.li,{children:"calculating the current voter weight"}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"integrating-with-realms",children:"Integrating with Realms"}),"\n",(0,i.jsx)(n.p,{children:"Once you have a program and client, you can integrate your plugin with Realms as follows:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Import it into ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/governance-ui",children:"Governance UI"})]}),"\n",(0,i.jsxs)(n.li,{children:["Register it in ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/governance-ui/blob/master/VoterWeightPlugins/clients/index.ts",children:"VoterWeightPlugins/clients/index.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:["List it in ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/governance-ui/blob/master/hub/components/EditRealmConfig/VotingStructureSelector/index.tsx",children:"VotingStructureSelector/index.tsx"})," and ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/governance-ui/blob/master/constants/plugins.ts",children:"constants/plugins.ts"})," to ensure it appears in the list of plugins when editing a DAO."]}),"\n",(0,i.jsx)(n.li,{children:"Define any optional UI components as needed."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:'The typical place where you will need to add dedicated UI components for your plugin is the "Voter Weight card",\r\nwhich shows the user what their voting power is, and how it is calculated.'}),"\n",(0,i.jsx)(n.p,{children:'If your plugin does not need any dedicated UI to show voting power, the "Vanilla" voting power UI will be used.'}),"\n",(0,i.jsx)(n.p,{children:"The vanilla voting power UI will:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'assume the user can "deposit" tokens into the DAO'}),"\n",(0,i.jsx)(n.li,{children:"show the votes simply using the plugin's calculatedVoteWeight without explanation"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This is a reasonable placeholder for some plugins, but to make life easier for users, plugin developers may want to add their own."}),"\n",(0,i.jsx)(n.p,{children:"To add your own:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["add your plugin name to ",(0,i.jsx)(n.code,{children:"pluginsWithDedicatedVotingPowerUI"})," in ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/governance-ui/blob/master/components/GovernancePower/Power/VotingPowerCards.tsx",children:"VotingPowerCards.tsx"})]}),"\n",(0,i.jsxs)(n.li,{children:["register your UI component inside ",(0,i.jsx)(n.code,{children:"CardForPlugin"})," in the same file"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"voter-weight-plugin-chaining",children:"Voter Weight Plugin Chaining"}),"\n",(0,i.jsx)(n.p,{children:"Realms supports chaining of voter weight plugins. This means that a voter's weight can be modified by multiple plugins\r\nin order."}),"\n",(0,i.jsx)(n.p,{children:"Plugins are structured like a linked-list, where each plugin registrar has a reference to the previous plugin program ID.\r\nThe final plugin program ID is registered against the governance on the realm."}),"\n",(0,i.jsxs)(n.p,{children:["When a voter weight is calculated, the Realms UI will call the ",(0,i.jsx)(n.code,{children:"update_voter_weight_record"})," instruction on each plugin in order.\r\nThe resultant voter weight record account should have the program ID of the final plugin program ID, and this will be checked\r\nby the SPL-Governance program."]}),"\n",(0,i.jsx)(n.p,{children:"To support plugin chaining in your plugin:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Ensure that your plugin registrar has a ",(0,i.jsx)(n.code,{children:"previous_voter_weight_plugin_program_id"})," field"]}),"\n",(0,i.jsxs)(n.li,{children:["Ensure that your ",(0,i.jsx)(n.code,{children:"update_voter_weight_record"})," instruction includes an ",(0,i.jsx)(n.code,{children:"input_voter_weight_record"})," account"]}),"\n",(0,i.jsxs)(n.li,{children:["Verify that the ",(0,i.jsx)(n.code,{children:"input_voter_weight_record"})," account has the program ID that matches the ",(0,i.jsx)(n.code,{children:"previous_voter_weight_plugin_program_id"})," field"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For examples of chainable plugins, see the Civic Pass and Quadratic plugins\r\nin the ",(0,i.jsx)(n.a,{href:"https://github.com/solana-labs/governance-program-library",children:"Governance Program Library"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"supporting-chaining-in-the-ui",children:"Supporting Chaining in the UI"}),"\n",(0,i.jsx)(n.p,{children:"There is relatively little specific logic required to support plugin chaining when adding your plugin to the UI."}),"\n",(0,i.jsxs)(n.p,{children:["The Realms code will automatically wire up your plugin with others in the chain, as long as your plugin client\r\nprovides a Registrar account that contains a ",(0,i.jsx)(n.code,{children:"previousVoterWeightPluginProgramId"})," property."]}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"previousVoterWeightPluginProgramId"})," is found, then Realms will pass in an input VWR belonging to that plugin\r\nto your plugin's ",(0,i.jsx)(n.code,{children:"updateVoterWeightRecord"})," instruction and ",(0,i.jsx)(n.code,{children:"calculateVoterWeight"})," function."]}),"\n",(0,i.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.p,{children:"Here is an example of a plugin registrar that supports chaining (using Anchor):"}),"\n",(0,i.jsx)(n.pre,{"data-language":"typescript","data-theme":"default",children:(0,i.jsxs)(n.code,{"data-language":"typescript","data-theme":"default",children:[(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"interface"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Registrar"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  governanceProgramId"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  realm"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  governingTokenMint"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  previousVoterWeightPluginProgramId"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"?:"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:";"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ...any other plugin-specific configuration"})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,i.jsx)(n.span,{className:"line",children:" "}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"MyPluginClient"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"extends"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Client"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"typeof"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"IDL"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"> {"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"//...other functions"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"getRegistrarAccount"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(realm"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" mint"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" { "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"registrar"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" } "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".getRegistrarPDA"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            realm"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            mint"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        );"})}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"program"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"account"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"registrar"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".fetchNullable"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"            registrar"})}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        )"})}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,i.jsx)(n.span,{className:"line",children:" "}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"async"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"calculateVoterWeight"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(voter"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" realm"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" mint"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"PublicKey"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" inputVoterWeight"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"BN"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"Promise"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"BN"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"null"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"> {"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"registrar"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".getRegistrarAccount"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(realm"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" mint);"})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:" "}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// This part varies depending on your plugin"})]}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"voteWeight"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"applyMyPluginFunction"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(registrar"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" inputVoterWeight);"})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "})}),"\n",(0,i.jsxs)(n.span,{className:"line",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" voteWeight;"})]}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,i.jsx)(n.span,{className:"line",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,i.jsx)(n.h4,{id:"input-weights-of-first-plugin",children:"Input Weights of First Plugin"}),"\n",(0,i.jsx)(n.p,{children:"The first plugin in the chain will receive the user's raw token balance as the input weight\r\n(or the token supply of the governance mint in the case of max voter weight plugins)."}),"\n",(0,i.jsx)(n.p,{children:"This may or may not be relevant to your plugin, so you may choose to ignore it. An example would be the NFT plugin,\r\nwhich uses the user's NFTs to calculate their voting power, and does not use their token balance, and the\r\nNFT collection details are defined in the plugin registrar."}),"\n",(0,i.jsxs)(n.p,{children:["If you are ignoring the input voter weight, you may not want to prompt the user to deposit their governance tokens\r\n(since doing so has no effect on their voting power). In this case, set the ",(0,i.jsx)(n.code,{children:"requiresInputVoterWeight"})," property\r\nto false. Set it explicitly to true to prompt the user to deposit their tokens."]}),"\n",(0,i.jsx)(n.p,{children:"Note, this toggle has no effect on the on-chain logic - the plugin will still receive the input voter weight.\r\nIt is purely a UI convenience."})]})}let d={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,l.a)(),e.components);return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)},pageOpts:{filePath:"pages/createplugin.mdx",route:"/createplugin",pageMap:[{kind:"MdxPage",name:"api",route:"/api"},{kind:"MdxPage",name:"branding",route:"/branding"},{kind:"MdxPage",name:"civicpass",route:"/civicpass"},{kind:"MdxPage",name:"config",route:"/config"},{kind:"MdxPage",name:"contribute",route:"/contribute"},{kind:"MdxPage",name:"council",route:"/council"},{kind:"MdxPage",name:"createplugin",route:"/createplugin"},{kind:"MdxPage",name:"delegation",route:"/delegation"},{kind:"MdxPage",name:"glossary",route:"/glossary"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"interface",route:"/interface"},{kind:"MdxPage",name:"nftplugin",route:"/nftplugin"},{kind:"MdxPage",name:"notifications",route:"/notifications"},{kind:"MdxPage",name:"quadratic",route:"/quadratic"},{kind:"Folder",name:"setup",route:"/setup",children:[{kind:"MdxPage",name:"daomultisig",route:"/setup/daomultisig"},{kind:"MdxPage",name:"daonft",route:"/setup/daonft"},{kind:"MdxPage",name:"daotoken",route:"/setup/daotoken"},{kind:"Meta",data:{daomultisig:"Multi-Signature DAO",daotoken:"Community Token DAO",daonft:"NFT Community DAO"}}]},{kind:"MdxPage",name:"spl-governance",route:"/spl-governance"},{kind:"MdxPage",name:"treasury",route:"/treasury"},{kind:"MdxPage",name:"vsr",route:"/vsr"},{kind:"MdxPage",name:"whatisdao",route:"/whatisdao"},{kind:"Meta",data:{"-":{type:"separator",title:"Getting Started"},index:"Introduction",interface:"Interface",glossary:"Glossary","--":{type:"separator",title:"Creation Wizard"},whatisdao:"What is a DAO?",setup:"DAOs Setup",config:"Configuration","---":{type:"separator",title:"User Guides"},delegation:"Delegation",treasury:"Treasury",council:"Council Members",civicpass:"Civic Pass",notifications:"Notifications",branding:"Logo & Banner","----":{type:"separator",title:"Developer Guides"},contribute:"Contribute",createplugin:"Voter Weight Plugin","-----":{type:"separator",title:"Plugins"},vsr:"VSR Voting",nftplugin:"NFT Voting",quadratic:"Quadratic Voting","------":{type:"separator",title:"Resources"},api:{title:"API ↗",href:"https://www.npmjs.com/package/@solana/spl-governance",newWindow:!0},"-------":{type:"separator",title:"Deep Dive"},"spl-governance":"SPL Governance"}}],flexsearch:{codeblocks:!0},title:"Create a Voter Weight Plugin",headings:c},pageNextRoute:"/createplugin",nextraLayout:t.ZP,themeConfig:o.Z};n.default=(0,r.j)(d)},1255:function(e,n,s){"use strict";var i=s(5893),r=s(1163),t=s(2169);n.Z={logo:(0,i.jsx)("b",{children:"Realms"}),docsRepositoryBase:"https://github.com/solana-labs/governance-docs/tree/master",project:{link:"https://github.com/solana-labs/governance-docs/tree/master"},chat:{link:"https://discord.gg/6UZHcNJFr8"},navbar:{extraContent:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("a",{href:"https://twitter.com/shuding_",target:"_blank",rel:"noopener noreferrer",children:(0,i.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M23.954 4.569c-.885.389-1.83.654-2.825.775a4.958 4.958 0 002.163-2.723 9.92 9.92 0 01-3.127 1.184 4.916 4.916 0 00-8.384 4.482 13.934 13.934 0 01-10.112-5.14 4.904 4.904 0 001.523 6.548 4.876 4.876 0 01-2.228-.616c-.054 2.162 1.515 4.188 3.763 4.64a4.905 4.905 0 01-2.212.083 4.928 4.928 0 004.604 3.417 9.872 9.872 0 01-6.102 2.104c-.395 0-.779-.023-1.17-.067a13.945 13.945 0 007.548 2.213c9.142 0 14.307-7.721 13.995-14.646a9.935 9.935 0 002.457-2.548z"})})})})},banner:{key:"2.0-release",text:(0,i.jsx)("a",{href:"https://discord.gg/6UZHcNJFr8",target:"_blank",children:"\uD83D\uDCA1 Is something not documented? Reach out to us in Discord →"})},footer:{text:(0,i.jsxs)("span",{children:["MIT ",new Date().getFullYear()," \xa9"," ",(0,i.jsx)("a",{href:"https://realms.today/",target:"_blank",children:"Realms"}),"."]})},useNextSeoProps:()=>({titleTemplate:"%s – Docs"}),head:()=>{let{asPath:e,defaultLocale:n,locale:s}=(0,r.useRouter)(),{frontMatter:o}=(0,t.ZR)(),l="https://docs.realms.today"+(n===s?e:"/".concat(s).concat(e));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("meta",{property:"og:url",content:l}),(0,i.jsx)("meta",{property:"og:title",content:o.title||"Realms"}),(0,i.jsx)("meta",{property:"og:description",content:o.description||"The home for on-chain communities in the @Solana ecosystem."})]})}}},5789:function(){}},function(e){e.O(0,[403,888,774,179],function(){return e(e.s=5617)}),_N_E=e.O()}]);